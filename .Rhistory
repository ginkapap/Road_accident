knitr::opts_chunk$set(echo = FALSE)
use_condaenv("/anaconda3/envs/m-team")
knitr::opts_chunk$set(echo = FALSE)
library(reticulate)
library(reshape2)
library(dplyr)
library(ggplot2)
library(mice)
library(tidyr)
library(DMwR)
library(gplots)
library(caret)
library(tidyverse)
library(leaflet)
library(xts)
library(chron)
knitr::opts_chunk$set(echo = FALSE)
use_python("/anaconda3/bin/python3.6", required = T)
use_condaenv("/anaconda3/envs/m-team")
source_python("/Users/liguanzhi/Desktop/iui.py")
knitr::opts_chunk$set(echo = FALSE)
use_python("/anaconda3/bin/python3.6", required = T)
use_condaenv("/anaconda3/envs/m-team")
source_python("//Users/liguanzhi/git/Road_accident/iui.py")
dfna
df21 %>% filter(accident_severity == 1) -> df23
df21 %>% filter(accident_severity != 1) -> df24
df23$tt <- as.POSIXct(df23$time, format="%H:%M:%S")
setNames(data.frame(table(df23$tt)),c("Date","Count")) ->dk
dk$Date <- as.POSIXct((dk$Date), tz = "GMT")
df24$tt <- as.POSIXct(df24$time, format="%H:%M:%S")
setNames(data.frame(table(df24$tt)),c("Date","Count")) ->dj
dj$Date <- as.POSIXct((dj$Date), tz = "GMT")
dk$id = "one"
dj$id = "two"
df = rbind(dj, dk)
ggplot(df, aes(x = df$Date,y=Count,color=id)) + geom_line(size = 0.25)  +
scale_x_datetime(date_labels = "%H:%M", date_breaks = "3 hour")+ scale_y_continuous(limits = c(0,250))+ stat_smooth(color = "#FC4E05", fill = "#FC4E18",method = "loess") + xlab("時間") + ylab("死亡車禍次數")+theme(text=element_text(family="黑體-繁 中黑", size=14))
df3 <- df2 %>% select(-time)
cormat <- round(cor(df3),2)
melted_cormat <- melt(cormat)
melted_cormat%>% filter(melted_cormat$Var1 == 'accident_severity')
ggplot(data = melted_cormat, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + theme(axis.text.x = element_text(angle=90, hjust=1, vjust=.5),axis.text=element_text(size=5))
df21$casualty_severity=factor(df21$casualty_severity)
ggplot(df21, aes(accident_severity, fill=casualty_severity)) + geom_bar(position="fill")
